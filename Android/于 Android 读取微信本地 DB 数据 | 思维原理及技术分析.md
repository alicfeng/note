## WechatRecord | å¾®ä¿¡è®°å½•è§£æ

No matter where I am, I will reply you immediately when I see the email.My Email: echo "YUBzYW1lZ28uY29tCg==" | base64 -d



#### å‰è¨€

è¯¥ç§»åŠ¨ç«¯è½¯ä»¶åŸºäº`Android`å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªè§£æå¾®ä¿¡æ•°æ®ä¿¡æ¯(åŒ…æ‹¬å¾®ä¿¡ä¸ªäººèµ„æ–™ã€è”ç³»äººã€èŠå¤©è®°å½•ç­‰)å¹¶é‡è£…æŠ¥æ–‡åŒæ­¥è‡³æœåŠ¡ç«¯çš„ä¸€æ¬¾åº”ç”¨ã€‚å…¶å®å®å±å…¬å¸ä¸šåŠ¡éœ€è¦è€Œå¼€å‘çš„ä¸€ä¸ªå°ç©æ„ï¼Œ`Android`å˜›~ç¬‘O(âˆ©_âˆ©)Oå“ˆå“ˆ~ã€‚

åº”ç”¨çš„åŸç†æ€ç»´åˆ†æï¼šé¦–å…ˆæ‹¿åˆ°å¾®ä¿¡åº”ç”¨çš„æœ¬åœ°`SQLite`æ•°æ®åº“æ–‡ä»¶( æ— ç½‘ç»œçš„æƒ…å†µä¸‹å¯ä»¥æ˜¾ç¤ºä¹‹å‰çš„èŠå¤©è®°å½•ï¼Œå› è€Œæœ¬åœ°å¿…æœ‰ç¼“å­˜æ•°æ®çš„è½½ä½“ã€Gä¸€ä¸‹ é¢ æ˜¯æœ¬åœ°æ•°æ® )ï¼Œåˆ†æåˆ°æœ¬åœ°ç¼“å­˜ä»¥åŠæ‰¾åˆ°æ–‡ä»¶çš„è·¯å¾„çŸ¥è¯†ç¬¬ä¸€æ­¥ï¼Œç¬¬äºŒéƒ¨éœ€è¦**ç§˜é’¥**è¿›ä¸€æ­¥æ‰“å¼€`db`æ–‡ä»¶ï¼Œæ‰¾åˆ°å¯†ç æ˜¯å¾ˆç®€å•çš„äº‹æƒ…( **å†æ­¤æ„Ÿè°¢å‰äººè´¡çŒ®** ) ï¼Œå¯ä»¥é€šè¿‡ç›¸å…³çš„ä¿¡æ¯è®¡ç®—å¾—åˆ°ï¼Œè‚¯å®šä¼šæœ‰äººé—®ï¼š**ä¸‡ä¸€å¾®ä¿¡å°†å…¶æ”¹äº†é‚£æ­¤æ–¹æ¡ˆæ­¤ä¸æ˜¯ä½œåºŸäº†å—ï¼Ÿ**ï¼ŒğŸ˜æ—¢ç„¶å¾®ä¿¡å‡­å…¶æŠ€æœ¯å®åŠ›æ”¹å˜äº†ï¼Œé‚£ä¹Ÿæ²¡åŠæ³•å‘€ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡è…¾è®¯ä¸ä¼šè½»è€Œæ˜“ä¸¾çš„å»åšè¿™ä¸€æ”¹åŠ¨çš„ï¼Œä¸ºä½•å‘¢ï¼Ÿ**è¿™æ ·ä¸€æ”¹åŠ¨çš„è¯ï¼Œå®¹æ˜“é€ æˆå¯¹ä¹‹å‰ç‰ˆæœ¬ä¸å…¼å®¹**ã€‚æ—¢ç„¶`db`æ–‡ä»¶æ‰¾åˆ°äº†ä»¥åŠç§˜é’¥ä¹Ÿæœ‰äº†ï¼Œæœ€åä¸€æ­¥å°±æ˜¯ç†è§£ä¸çŒœæµ‹æ•°æ®è¡¨çš„ç»“æ„ä¸å…³ç³»å»åšä¸šåŠ¡çš„å¼€å‘ã€‚



#### æ ¸å¿ƒæŠ€æœ¯

- **`uin`ç†è§£ä¸è·å–**

  > `uin`ç®€å•è€Œè¨€å°±æ˜¯å¾®ä¿¡ç™»å½•çš„è¯†åˆ«å·ï¼Œè®¾å¤‡å¿…é¡»æœ‰ç™»å½•çš„å†å²æ‰æœ‰ã€‚`uin`æ˜¯å¦‚ä½•è·å–çš„å‘¢ï¼Ÿ

  ```java
  # uidåœ¨aunt_info_key_prefs.xmlæ–‡ä»¶é‡Œé¢
  # å…·ä½“çš„è·¯å¾„ä¸º
  "/data/data/com.tencent.mm/shared_prefs/auth_info_key_prefs.xml"
  
  # uinçš„å€¼ä¸º_auth_uinæ ‡ç­¾çš„å€¼,å¦‚ä¸‹æ˜¯å®ä¾‹æ–‡ä»¶ï¼Œå¯å€ŸåŠ©jsoupä¾èµ–åº“å³å¯è§£æå€¼
  ```

  

- **`imeiç `**

  > ç§»åŠ¨è®¾å¤‡çš„å”¯ä¸€ç¼–ç ï¼ŒåŒå¡åŒå¾…çš„ä¼šæœ‰ä¸¤ä¸ªã€‚ä¸æ•°æ®åº“ç§˜é’¥æ¯æ¯ç›¸å…³ã€‚

  ```
  public static String imei(Context context) {
      try {
      	//å®ä¾‹åŒ–TelephonyManagerå¯¹è±¡
      	TelephonyManager telephonyManager = (TelephonyManager) 	context.getSystemService(Context.TELEPHONY_SERVICE);
      	String imei = telephonyManager.getDeviceId();
      	if (imei == null) {
      		imei = "";
      	}
      	return imei;
      } catch (Exception e) {
      	e.printStackTrace();
      }
      return null;
  }
  ```



- **æ•°æ®åº“è·¯å¾„**

  ```java
  # è·¯å¾„ä¸º
  "/data/data/com.tencent.mm/MicroMsg/" + md5("mm" + uin) + "/EnMicroMsg.db";
  ```

  

- **æ•°æ®åº“çš„å¯†ç **

  > ç§˜é’¥ä¸º`emei`+`uin`çš„`md5`æˆªå–å‰ä¸ƒä½å†è½¬å¤§å†™å³å¯è·å–ã€‚

  ```java
  md5(imei + uin))).substring(0, 7).toLowerCase()
  ```



- **æ•°æ®åº“è¯»å†™æ“ä½œ**

  ```java
  import net.sqlcipher.Cursor;
  import net.sqlcipher.SQLException;
  import net.sqlcipher.database.SQLiteDatabase;
  import net.sqlcipher.database.SQLiteDatabaseHook;
  
  SQLiteDatabase.loadLibs(context);
  SQLiteDatabaseHook hook = new SQLiteDatabaseHook() {
  	@Override
      public void preKey(SQLiteDatabase database) {
  
      }
  
      @Override
      public void postKey(SQLiteDatabase database) {
          database.rawExecSQL("PRAGMA cipher_migrate;"); // å…¼å®¹2.0çš„æ•°æ®åº“
      }
  };
  String file = "æ•°æ®åº“å¤‡ä»½åçš„æ–‡ä»¶è·¯å¾„;
  String password = "ç§˜é’¥";
  SQLiteDatabase database = SQLiteDatabase.openOrCreateDatabase(file, password, null, hook);
  ... ...
  ```

